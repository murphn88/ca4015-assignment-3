
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1. Data Exploration &amp; Pre-Processing &#8212; Artist Recommender System</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Matrix Factorization" href="matrix_fact.html" />
    <link rel="prev" title="Introduction" href="introd.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Artist Recommender System</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introd.html">
   Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Methodology
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1. Data Exploration &amp; Pre-Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="matrix_fact.html">
   2. Matrix Factorization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="softmax.html">
   3. Softmax model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lightgcn_mod.html">
   4. LightGCN
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="content_based.html">
   5. Content-Based Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Conclusion.html">
   6. Conclusion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bib.html">
   7. Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/data_description.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fdata_description.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/data_description.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   1.1. Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#read-in-data">
   1.2. Read in Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview-of-the-dataframes">
   1.3. Overview of the DataFrames
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#artists">
     1.3.1. artists
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tags">
     1.3.2. tags
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#user-artists">
     1.3.3. user_artists
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#user-friends">
     1.3.4. user_friends
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#user-tagged-artists">
     1.3.5. user_tagged_artists
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-exploration-visualisations">
   1.4. Data Exploration &amp; Visualisations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#number-of-artists-listened-to-by-each-user">
     1.4.1. Number of artists listened to by each user
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#number-of-listeners-per-artist">
     1.4.2. Number of listeners per artist
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#weight-for-each-user-artist-pair">
     1.4.3. Weight for each user/artist pair
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#determine-cut-off-for-allowable-weight-values">
       1.4.3.1. Determine cut-off for allowable weight values
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scale-the-weights-between-1-5">
       1.4.3.2. Scale the weights between 1-5
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#most-popular-artists">
     1.4.4. Most popular artists
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#most-popular-tags">
     1.4.5. Most popular tags
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#can-tags-be-used-as-genres">
     1.4.6. Can tags be used as genres?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-similar-are-friends-music-tastes">
     1.4.7. How similar are friends’ music tastes?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-dataframes-for-recommendation-building">
   1.5. Create DataFrames for Recommendation Building
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#artist-information">
     1.5.1. Artist Information
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#listens-per-artist">
     1.5.2. Listens Per Artist
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#save-files">
     1.5.3. Save Files
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="data-exploration-pre-processing">
<h1><span class="section-number">1. </span>Data Exploration &amp; Pre-Processing<a class="headerlink" href="#data-exploration-pre-processing" title="Permalink to this headline">¶</a></h1>
<p>Before we begin building a recommender system we must first get a sense of the dataset. The objective of  this chapter is to explore the dataset and to perform any necessary pre-processing of the data. We will use pandas to read in and explore the data. We will sanity check the data, handle inconsistencies and outliers, and make sure the data can be used to build an accurate and reliable recommender system.</p>
<div class="section" id="imports">
<h2><span class="section-number">1.1. </span>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="read-in-data">
<h2><span class="section-number">1.2. </span>Read in Data<a class="headerlink" href="#read-in-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">artists</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;..</span><span class="se">\\</span><span class="s1">data</span><span class="se">\\</span><span class="s1">hetrec2011-lastfm-2k</span><span class="se">\\</span><span class="s1">artists.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
<span class="n">tags</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;..</span><span class="se">\\</span><span class="s1">data</span><span class="se">\\</span><span class="s1">hetrec2011-lastfm-2k</span><span class="se">\\</span><span class="s1">tags.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
<span class="n">user_artists</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;..</span><span class="se">\\</span><span class="s1">data</span><span class="se">\\</span><span class="s1">hetrec2011-lastfm-2k</span><span class="se">\\</span><span class="s1">user_artists.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
<span class="n">user_friends</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;..</span><span class="se">\\</span><span class="s1">data</span><span class="se">\\</span><span class="s1">hetrec2011-lastfm-2k</span><span class="se">\\</span><span class="s1">user_friends.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
<span class="n">user_tagged_artists</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;..</span><span class="se">\\</span><span class="s1">data</span><span class="se">\\</span><span class="s1">hetrec2011-lastfm-2k</span><span class="se">\\</span><span class="s1">user_taggedartists.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="overview-of-the-dataframes">
<h2><span class="section-number">1.3. </span>Overview of the DataFrames<a class="headerlink" href="#overview-of-the-dataframes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="artists">
<h3><span class="section-number">1.3.1. </span>artists<a class="headerlink" href="#artists" title="Permalink to this headline">¶</a></h3>
<p>This dataframe contains information about 17,632 music artists listened to and tagged by the users.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">artists</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>url</th>
      <th>pictureURL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>MALICE MIZER</td>
      <td>http://www.last.fm/music/MALICE+MIZER</td>
      <td>http://userserve-ak.last.fm/serve/252/10808.jpg</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Diary of Dreams</td>
      <td>http://www.last.fm/music/Diary+of+Dreams</td>
      <td>http://userserve-ak.last.fm/serve/252/3052066.jpg</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Carpathian Forest</td>
      <td>http://www.last.fm/music/Carpathian+Forest</td>
      <td>http://userserve-ak.last.fm/serve/252/40222717...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of rows: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">artists</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">artists</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span><span class="n">artists</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;unique_entries&#39;</span><span class="p">,</span><span class="s1">&#39;null_values&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>number of rows: 17632
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique_entries</th>
      <th>null_values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>17632</td>
      <td>0</td>
    </tr>
    <tr>
      <th>name</th>
      <td>17632</td>
      <td>0</td>
    </tr>
    <tr>
      <th>url</th>
      <td>17632</td>
      <td>0</td>
    </tr>
    <tr>
      <th>pictureURL</th>
      <td>17188</td>
      <td>444</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Delete pcitureURL column</strong><br />
The column pcitureURL contains links that cannot be accessed, and has no use to us, so we will delete it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="n">artists</span><span class="p">[</span><span class="s1">&#39;pictureURL&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Reset ids</strong><br />
Set id to start from 0 and to be consecutive.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">artist_id_dict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">artists</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">artists</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">artists</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">artists</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">artist_id_dict</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of rows: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">artists</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">artists</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span><span class="n">artists</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;unique_entries&#39;</span><span class="p">,</span><span class="s1">&#39;null_values&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>number of rows: 17632
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique_entries</th>
      <th>null_values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>17632</td>
      <td>0</td>
    </tr>
    <tr>
      <th>name</th>
      <td>17632</td>
      <td>0</td>
    </tr>
    <tr>
      <th>url</th>
      <td>17632</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<!-- The number of unique entries for id, name, and url matches the number of rows (17,632). Thus, each artist has a unique id, name, and url meaning there are no duplicates or null values that need to be addressed. --></div>
<div class="section" id="tags">
<h3><span class="section-number">1.3.2. </span>tags<a class="headerlink" href="#tags" title="Permalink to this headline">¶</a></h3>
<p>This dataframe contains the set of all tags available in the dataset. Tags can be informative of the musical genre.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tags</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tagID</th>
      <th>tagValue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>metal</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>alternative metal</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>goth rock</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of rows: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tags</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">tags</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span><span class="n">tags</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;unique_entries&#39;</span><span class="p">,</span><span class="s1">&#39;null_values&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>number of rows: 11946
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique_entries</th>
      <th>null_values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>tagID</th>
      <td>11946</td>
      <td>0</td>
    </tr>
    <tr>
      <th>tagValue</th>
      <td>11946</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Reset ids</strong><br />
Similar to artist id, reset tagID to start from 0 and to be consecutive.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tags_dict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tags</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">tags</span><span class="o">.</span><span class="n">tagID</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">tags</span><span class="o">.</span><span class="n">tagID</span> <span class="o">=</span> <span class="n">tags</span><span class="o">.</span><span class="n">tagID</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tags_dict</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<!-- Again, there are no duplicates or null values present. --></div>
<div class="section" id="user-artists">
<h3><span class="section-number">1.3.3. </span>user_artists<a class="headerlink" href="#user-artists" title="Permalink to this headline">¶</a></h3>
<p>The dataframe contains the artists listened to by each user, as well as a listening count (weight) for each user, artist pair.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_artists</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userID</th>
      <th>artistID</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>51</td>
      <td>13883</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>52</td>
      <td>11690</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>53</td>
      <td>11351</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>54</td>
      <td>10300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>55</td>
      <td>8983</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of rows: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">user_artists</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">user_artists</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span><span class="n">user_artists</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;unique_entries&#39;</span><span class="p">,</span><span class="s1">&#39;null_values&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>number of rows: 92834
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique_entries</th>
      <th>null_values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>userID</th>
      <td>1892</td>
      <td>0</td>
    </tr>
    <tr>
      <th>artistID</th>
      <td>17632</td>
      <td>0</td>
    </tr>
    <tr>
      <th>weight</th>
      <td>5436</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Reset userID and Map artistID</strong><br />
Reset userID to start from 0 and to be consecutive.<br />
Replace artistIDs with the corresponding ids in artists.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_id_dict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">user_artists</span><span class="o">.</span><span class="n">userID</span><span class="o">.</span><span class="n">nunique</span><span class="p">()),</span><span class="n">index</span><span class="o">=</span><span class="n">user_artists</span><span class="o">.</span><span class="n">userID</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">user_artists</span><span class="o">.</span><span class="n">userID</span> <span class="o">=</span> <span class="n">user_artists</span><span class="o">.</span><span class="n">userID</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">user_id_dict</span><span class="p">)</span> 

<span class="n">user_artists</span><span class="o">.</span><span class="n">artistID</span> <span class="o">=</span> <span class="n">user_artists</span><span class="o">.</span><span class="n">artistID</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">artist_id_dict</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="user-friends">
<h3><span class="section-number">1.3.4. </span>user_friends<a class="headerlink" href="#user-friends" title="Permalink to this headline">¶</a></h3>
<p>This dataframe contains the friend relations between users in the dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_friends</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userID</th>
      <th>friendID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>275</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>428</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>515</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of rows: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">user_friends</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">user_friends</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span><span class="n">user_friends</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;unique_entries&#39;</span><span class="p">,</span><span class="s1">&#39;null_values&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>number of rows: 25434
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique_entries</th>
      <th>null_values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>userID</th>
      <td>1892</td>
      <td>0</td>
    </tr>
    <tr>
      <th>friendID</th>
      <td>1892</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>While the dataframe consists of 25,434 rows, it in fact only contains half this amount (12,717) of bi-directional relations, each relation is included twice, an example of which can be seen in the next cell’s output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_friends</span><span class="p">[((</span><span class="n">user_friends</span><span class="p">[</span><span class="s1">&#39;userID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">user_friends</span><span class="p">[</span><span class="s1">&#39;friendID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">275</span><span class="p">))</span> <span class="o">|</span> <span class="p">((</span><span class="n">user_friends</span><span class="p">[</span><span class="s1">&#39;userID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">275</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">user_friends</span><span class="p">[</span><span class="s1">&#39;friendID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userID</th>
      <th>friendID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>275</td>
    </tr>
    <tr>
      <th>3837</th>
      <td>275</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Map userID and friendID</strong><br />
Replace both userID and friendID so they corresponding with the intended users.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_friends</span><span class="o">.</span><span class="n">userID</span> <span class="o">=</span> <span class="n">user_friends</span><span class="o">.</span><span class="n">userID</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">user_id_dict</span><span class="p">)</span> 
<span class="n">user_friends</span><span class="o">.</span><span class="n">friendID</span> <span class="o">=</span> <span class="n">user_friends</span><span class="o">.</span><span class="n">friendID</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">user_id_dict</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="user-tagged-artists">
<h3><span class="section-number">1.3.5. </span>user_tagged_artists<a class="headerlink" href="#user-tagged-artists" title="Permalink to this headline">¶</a></h3>
<p>This dataframe contains the tag assignments of artists provided by each user and the accompanying date of when the tag assignments were done.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userID</th>
      <th>artistID</th>
      <th>tagID</th>
      <th>day</th>
      <th>month</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>52</td>
      <td>13</td>
      <td>1</td>
      <td>4</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>52</td>
      <td>15</td>
      <td>1</td>
      <td>4</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>52</td>
      <td>18</td>
      <td>1</td>
      <td>4</td>
      <td>2009</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of rows: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span><span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;unique_entries&#39;</span><span class="p">,</span><span class="s1">&#39;null_values&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>number of rows: 186479
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique_entries</th>
      <th>null_values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>userID</th>
      <td>1892</td>
      <td>0</td>
    </tr>
    <tr>
      <th>artistID</th>
      <td>12523</td>
      <td>0</td>
    </tr>
    <tr>
      <th>tagID</th>
      <td>9749</td>
      <td>0</td>
    </tr>
    <tr>
      <th>day</th>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>month</th>
      <td>12</td>
      <td>0</td>
    </tr>
    <tr>
      <th>year</th>
      <td>10</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Interestingly each user has tagged at least one artist but not all artists have received a tag. The number of unique entries for the day and year seems odd and will be further investigated in the next two cells.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    182948
5      1505
6      1469
9       557
Name: day, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Considering the size of the dataframe it is inprobable that users only ever tagged on the same four days of every month, and is instead likely indicative of the days when the data was collected. Therefore, we will not place any significance on the day in further analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2010    54998
2009    43366
2008    40273
2007    20415
2011    15125
2006     9814
2005     2483
1956        3
1957        1
1979        1
Name: year, dtype: int64
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="http://Last.fm">Last.fm</a> was founded in 2002, and the internet in 1983! Therefore, the 4 dates that correspond to the years 1956, 1957, or 1979 are obvious errors. The dataset was compiled in 2011 so it is conceivable that the data collected was created sometime between 2005 and 2011.</p>
<p><strong>Replace years before 2005</strong><br />
Replace any year before 2005 with 2005</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">user_tagged_artists</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2005</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2005</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Map userID, artistID and tagID</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">userID</span> <span class="o">=</span> <span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">userID</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">user_id_dict</span><span class="p">)</span> 
<span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">artistID</span> <span class="o">=</span> <span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">artistID</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">artist_id_dict</span><span class="p">)</span> 
<span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">tagID</span> <span class="o">=</span> <span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">tagID</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tags_dict</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="data-exploration-visualisations">
<h2><span class="section-number">1.4. </span>Data Exploration &amp; Visualisations<a class="headerlink" href="#data-exploration-visualisations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="number-of-artists-listened-to-by-each-user">
<h3><span class="section-number">1.4.1. </span>Number of artists listened to by each user<a class="headerlink" href="#number-of-artists-listened-to-by-each-user" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_artists_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">artists_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">user</span><span class="p">,</span> <span class="n">artists_df</span> <span class="ow">in</span> <span class="n">user_artists</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;userID&#39;</span><span class="p">)])</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s1">&#39;number_of_artists&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;counts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">user_artists_count</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;number_of_artists&#39;</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="s1">&#39;counts&#39;</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of Artists Listened to by Users&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/data_description_53_0.png" src="_images/data_description_53_0.png" />
</div>
</div>
<p>This plot is left skewed, with the vast majority of users having listened to 40-50 unique artists. Only 51 users, or 2.7% of users, have listened to fewer than 40 artists. This is reassuring as we are planning to use this dataset to build a recommender system. The more artists listened to by each user the better the recommender system should perform as the system will be better able to determine users’ musical interests and tastes.</p>
</div>
<div class="section" id="number-of-listeners-per-artist">
<h3><span class="section-number">1.4.2. </span>Number of listeners per artist<a class="headerlink" href="#number-of-listeners-per-artist" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">listeners_count</span> <span class="o">=</span> <span class="n">user_artists</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;artistID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;number_of_listeners&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">listeners_count</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;number_of_listeners&#39;</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of Listeners per Artist&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/data_description_56_0.png" src="_images/data_description_56_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">listeners_count</span><span class="o">.</span><span class="n">number_of_listeners</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    17632.000000
mean         5.265086
std         20.620315
min          1.000000
25%          1.000000
50%          1.000000
75%          3.000000
max        611.000000
Name: number_of_listeners, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>This right skewed plot is not ideal. It is common practice for recommender systems to disgard items (in this case artists) with few iterations. However, 50% of artists in this dataset have only been listened to by a single user. If we were to exclude artists with less than a certain number of interactions we lose the majority of the dataset so we will work with what we have.</p>
</div>
<div class="section" id="weight-for-each-user-artist-pair">
<h3><span class="section-number">1.4.3. </span>Weight for each user/artist pair<a class="headerlink" href="#weight-for-each-user-artist-pair" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_artists</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     92834.00000
mean        745.24393
std        3751.32208
min           1.00000
25%         107.00000
50%         260.00000
75%         614.00000
max      352698.00000
Name: weight, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;darkgrid&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span><span class="n">user_artists</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/data_description_61_0.png" src="_images/data_description_61_0.png" />
</div>
</div>
<p>The distribution is extremely left skewed. 75% of weights are less than 614, yet the max weight is 352,698. There are extreme outliers. We believe the dataset contains data from 2005-2011. For a user to have listened to a certain artist 352,698 times over that peroiod they would have had to listen to that artist roughly 1,600 times every day. It is unlikey that these extreme outliers are extreme music lovers and is instead more conceivable that there are errors in the data.</p>
<div class="section" id="determine-cut-off-for-allowable-weight-values">
<h4><span class="section-number">1.4.3.1. </span>Determine cut-off for allowable weight values<a class="headerlink" href="#determine-cut-off-for-allowable-weight-values" title="Permalink to this headline">¶</a></h4>
<p>To determine the maximum weight allowed, we will group users by weight bin (0-500, 500-1000, 1000-1500 …). The logic we will apply will assume that if you have listened to one artist betweeen 500-1000 times then you’ve probably listened to other artists between 0-500 times. If you are a big music listener and have listened to your absolute favourite artist 2000+ times, then you have probably listened to another of your favourite artists between 1500-2000 times.</p>
<p>We will calculate the percentage of users in each bin which were also in the previous bin. E.g. what percentage of users who have at least one weight between 3000 and 3500, also have at least one weight between 2500 and 3000?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pc_users_in_both</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">incrs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">user_artists</span><span class="o">.</span><span class="n">weight</span><span class="p">),</span><span class="mi">500</span><span class="p">))</span>
<span class="n">users_below</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="k">for</span> <span class="n">inc</span> <span class="ow">in</span> <span class="n">incrs</span><span class="p">:</span>
    <span class="n">users_in_inc</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">user_artists</span><span class="p">[(</span><span class="n">user_artists</span><span class="o">.</span><span class="n">weight</span> <span class="o">&gt;</span> <span class="n">inc</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">user_artists</span><span class="o">.</span><span class="n">weight</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">inc</span> <span class="o">+</span> <span class="mi">500</span><span class="p">))]</span><span class="o">.</span><span class="n">userID</span><span class="p">)</span>
    <span class="n">users_in_both</span> <span class="o">=</span> <span class="n">users_below</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">users_in_inc</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">users_below</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pc_users</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">users_in_both</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">users_below</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">pc_users_in_both</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pc_users</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pc_users_in_both</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">users_below</span> <span class="o">=</span> <span class="n">users_in_inc</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;darkgrid&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">incrs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">pc_users_in_both</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% o</span><span class="s1">f users in bin also in lower bin&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;start of bin&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;percentage of users also in directly lower bin&#39;</span><span class="p">,</span><span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span><span class="mi">80000</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">incrs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">pc_users_in_both</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% o</span><span class="s1">f users in bin also in lower bin (zoomed in)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;start of bin&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;percentage of users also in directly lower bin&#39;</span><span class="p">,</span><span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span><span class="mi">10000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/data_description_65_0.png" src="_images/data_description_65_0.png" />
</div>
</div>
<p>As expected the percentage of users in a bin and in the consecutive bin initially steadily decreases, as most users reach their max weight. However, the plot quick starts to fluctuate. To decide on the max allowable weight, we will focus on the right zoomed in graph. Up utill around 3,500 the graph is almost linear. Therefore, we will set the max allowable weight to the 3,500. It is possible that we will lose some super fans through this process but it is better than having errors in the data. For all weights above 3,500 we will set them to the user’s median weight if it is below 3,500, otherwise it will be set to the median weight of all users’ weights.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">users_to_be_updated</span> <span class="o">=</span> <span class="n">user_artists</span><span class="o">.</span><span class="n">userID</span><span class="p">[</span><span class="n">user_artists</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3500</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">users_artists_below_thres</span> <span class="o">=</span> <span class="n">user_artists</span><span class="p">[</span><span class="n">user_artists</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3500</span><span class="p">]</span>
<span class="n">user_new_weights_dict</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">users_artists_below_thres</span><span class="p">[</span><span class="n">users_artists_below_thres</span><span class="o">.</span><span class="n">userID</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">users_to_be_updated</span><span class="p">))]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;userID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">median</span><span class="p">())</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">user_artists</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">weight</span> <span class="o">&gt;</span> <span class="mi">3500</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">row</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">user_new_weights_dict</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">userID</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">artist_median</span> <span class="o">=</span> <span class="n">user_artists</span><span class="p">[</span><span class="n">user_artists</span><span class="p">[</span><span class="s1">&#39;artistID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="o">.</span><span class="n">artistID</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">artist_median</span> <span class="o">&lt;</span> <span class="mi">3500</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">user_artists</span><span class="p">[</span><span class="n">user_artists</span><span class="p">[</span><span class="s1">&#39;artistID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="o">.</span><span class="n">artistID</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">user_artists</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">user_artists</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Boxplot of weights after setting cut-off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/data_description_68_0.png" src="_images/data_description_68_0.png" />
</div>
</div>
</div>
<div class="section" id="scale-the-weights-between-1-5">
<h4><span class="section-number">1.4.3.2. </span>Scale the weights between 1-5<a class="headerlink" href="#scale-the-weights-between-1-5" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_weight</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">user_artists</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
<span class="n">max_weight</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">user_artists</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">user_artists</span><span class="p">)):</span>
    <span class="n">user_artists</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">user_artists</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],[</span><span class="n">min_weight</span><span class="p">,</span><span class="n">max_weight</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_artists</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userID</th>
      <th>artistID</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>92834.000000</td>
      <td>92834.000000</td>
      <td>92834.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>944.222483</td>
      <td>3235.736724</td>
      <td>1.536476</td>
    </tr>
    <tr>
      <th>std</th>
      <td>546.751074</td>
      <td>4197.216910</td>
      <td>0.664117</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>470.000000</td>
      <td>430.000000</td>
      <td>1.120034</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>944.000000</td>
      <td>1237.000000</td>
      <td>1.291512</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1416.000000</td>
      <td>4266.000000</td>
      <td>1.667619</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1891.000000</td>
      <td>17631.000000</td>
      <td>5.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="most-popular-artists">
<h3><span class="section-number">1.4.4. </span>Most popular artists<a class="headerlink" href="#most-popular-artists" title="Permalink to this headline">¶</a></h3>
<p>To find the most popular artists we will use two approaches. The first will sum all listens per artist and the second will perform a count of unique listeners per artist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">artist_pop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">user_artists</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;artistID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()),</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">user_artists</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;artistID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">sum</span><span class="p">())],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">set_axis</span><span class="p">([</span><span class="s1">&#39;listeners&#39;</span><span class="p">,</span> <span class="s1">&#39;listens&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">artist_pop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">artist_pop</span><span class="p">,</span> <span class="n">artists</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;artistID&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
<span class="n">bylistens</span> <span class="o">=</span> <span class="n">artist_pop</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;listens&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">bylisteners</span> <span class="o">=</span> <span class="n">artist_pop</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;listeners&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">bylistens</span><span class="o">.</span><span class="n">listens</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">bylistens</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="s2">&quot;crest_r&quot;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;listens&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;artist&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;most popular artists by number of LISTENS&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">bylisteners</span><span class="o">.</span><span class="n">listeners</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">bylisteners</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="s2">&quot;rocket&quot;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;listeners&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;artist&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;most popular artists by number of LISTENERS&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/data_description_75_0.png" src="_images/data_description_75_0.png" />
</div>
</div>
<p>Lady Gaga appears as the top artist in both, this is reflective of listening tastes for the time period that the data was collected. While there are some differences between the two charts, on the whole popular artists have the most listens and listeners.</p>
</div>
<div class="section" id="most-popular-tags">
<h3><span class="section-number">1.4.5. </span>Most popular tags<a class="headerlink" href="#most-popular-tags" title="Permalink to this headline">¶</a></h3>
<p><strong>Remove special characters</strong><br />
Special characters are causing almost identical tags to be counted as two different tags. This is an issue for tags such as 80’s and 80s. To combat this we will remove all special characters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tag_dict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tags</span><span class="o">.</span><span class="n">tagValue</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">tags</span><span class="o">.</span><span class="n">tagID</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">user_tagged_artists_tag</span> <span class="o">=</span> <span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">user_tagged_artists_tag</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_tagged_artists_tag</span><span class="o">.</span><span class="n">tagID</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tag_dict</span><span class="p">)</span>
<span class="n">user_tagged_artists_tag</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="n">user_tagged_artists_tag</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">char</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">if</span> <span class="n">char</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Group on tag</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tags_ranked</span> <span class="o">=</span> <span class="n">user_tagged_artists_tag</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;counts&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;counts&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">tags_ranked</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">counts</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">tags_ranked</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Greens_r&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;count of tag usage&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;most used tags&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/data_description_82_0.png" src="_images/data_description_82_0.png" />
</div>
</div>
<p>No big surprises here.</p>
</div>
<div class="section" id="can-tags-be-used-as-genres">
<h3><span class="section-number">1.4.6. </span>Can tags be used as genres?<a class="headerlink" href="#can-tags-be-used-as-genres" title="Permalink to this headline">¶</a></h3>
<p>From looking at the top tags it appears that they could be used as item features representing artist genres. I want to determine how common the top 20 tags are. For each artist tagged, I will check if at least one of their tags is also in the top 20 overall tags.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top20tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">tags_ranked</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="c1"># artist_tag = user_tagged_artists.copy()</span>
<span class="c1"># artist_tag[&#39;tagValue&#39;] = artist_tag.tagID.map(tag_dict)</span>
<span class="n">artist_tagSet</span> <span class="o">=</span> <span class="n">user_tagged_artists_tag</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;artistID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;tagSet&#39;</span><span class="p">)</span>
<span class="n">artists_with_top_tag</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">artist_tagSet</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">inters</span> <span class="o">=</span> <span class="n">top20tags</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">tagSet</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inters</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">artists_with_top_tag</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">pc_artists</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">artists_with_top_tag</span><span class="o">/</span><span class="n">artist_tagSet</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Percentage of tagged artists with a tag in top 20 tags: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pc_artists</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of tagged artists with a tag in top 20 tags: 63%
</pre></div>
</div>
</div>
</div>
<p>We can make an assumption about the primary genre of 63% of tagged artists using this approach. However, as not all artist are tagged, this would actually only cover approximately 46% of all artists. Nevertheless, there are too many unique tags to one-hot-encode all of the tags, so we will procede with the top 20 tags.</p>
<p><strong>Approach</strong>:</p>
<ul class="simple">
<li><p>compute set of 20 most used tags: top20tags (done)</p></li>
</ul>
<p>For each artist:</p>
<ul class="simple">
<li><p>Collect set of all tags: artist_tagSet</p></li>
<li><p>Find intersection of artist_tagSet and top20tags</p></li>
<li><p>If no mutual tags, leave artist tag as no_tag</p></li>
<li><p>Else if only one mutual tag, set artist tag as mutual tag</p></li>
<li><p>Else, from the set of mutual tags, find the most tag for that artist</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top20tags</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;80s&#39;,
 &#39;90s&#39;,
 &#39;alternative&#39;,
 &#39;alternativerock&#39;,
 &#39;ambient&#39;,
 &#39;british&#39;,
 &#39;classicrock&#39;,
 &#39;dance&#39;,
 &#39;electronic&#39;,
 &#39;experimental&#39;,
 &#39;femalevocalists&#39;,
 &#39;hardrock&#39;,
 &#39;hiphop&#39;,
 &#39;indie&#39;,
 &#39;indierock&#39;,
 &#39;metal&#39;,
 &#39;newwave&#39;,
 &#39;pop&#39;,
 &#39;rock&#39;,
 &#39;singersongwriter&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tag_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;no_tag&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">artist_tagSet</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">artist_tagSet</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">inters</span> <span class="o">=</span> <span class="n">top20tags</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">tagSet</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">tag_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inters</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">inters</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">tag_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_tagged_artists_tag</span><span class="p">[</span><span class="n">user_tagged_artists_tag</span><span class="o">.</span><span class="n">artistID</span> <span class="o">==</span> <span class="n">row</span><span class="o">.</span><span class="n">artistID</span><span class="p">][</span><span class="n">user_tagged_artists_tag</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">inters</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;counts&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;counts&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">artist_tagSet</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tag_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\User\AppData\Local\Temp/ipykernel_3016/3829306717.py:7: UserWarning: Boolean Series key will be reindexed to match DataFrame index.
  tag_list[index] = user_tagged_artists_tag[user_tagged_artists_tag.artistID == row.artistID][user_tagged_artists_tag.tag.isin(inters)].groupby(&#39;tag&#39;).tag.count().reset_index(name=&#39;counts&#39;).sort_values(&#39;counts&#39;,ascending=False).tag[0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">artist_tagSet</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>artistID</th>
      <th>tagSet</th>
      <th>tag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>{weeabo, jrock, japanese, gothic, betterthanla...</td>
      <td>no_tag</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>{truegothemo, seenlive, german, gothicrock, vo...</td>
      <td>ambient</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>{blackmetal, norwegianblackmetal, saxophones, ...</td>
      <td>no_tag</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>One-Hot Encoding</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">genres</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">artist_tagSet</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">artist_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">artists</span><span class="p">,</span> <span class="n">genres</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">del</span> <span class="n">artist_features</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">artist_features</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>80s</th>
      <th>90s</th>
      <th>alternative</th>
      <th>alternativerock</th>
      <th>ambient</th>
      <th>british</th>
      <th>classicrock</th>
      <th>dance</th>
      <th>...</th>
      <th>hardrock</th>
      <th>hiphop</th>
      <th>indie</th>
      <th>indierock</th>
      <th>metal</th>
      <th>newwave</th>
      <th>no_tag</th>
      <th>pop</th>
      <th>rock</th>
      <th>singersongwriter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>MALICE MIZER</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Diary of Dreams</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Carpathian Forest</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 23 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="how-similar-are-friends-music-tastes">
<h3><span class="section-number">1.4.7. </span>How similar are friends’ music tastes?<a class="headerlink" href="#how-similar-are-friends-music-tastes" title="Permalink to this headline">¶</a></h3>
<p>This is to determine how useful the friends relationships are. We will calculate the percentage of artists that friends have in common.</p>
<p><strong>Remove repeated relationships</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_friends</span> <span class="o">=</span> <span class="n">user_friends</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">user_friends</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">user_friends</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">user_friends</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>Percentage of artists in common between a pair of friends = <span class="math notranslate nohighlight">\(\frac{Friend1 artists \bigcap Friend2 artists}{Friend1 artists \bigcup Friend2}\times 100\)</span></p>
<!-- 

Percentage of artists in common between a pair of friends = $\frac{Intersection of aritst lists}{Union of aritst lists}\times 100$ --><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">artists_incommon</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">user_friends</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">friend1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">user_artists</span><span class="p">[</span><span class="n">user_artists</span><span class="o">.</span><span class="n">userID</span> <span class="o">==</span> <span class="n">row</span><span class="o">.</span><span class="n">userID</span><span class="p">]</span><span class="o">.</span><span class="n">artistID</span><span class="p">)</span>
    <span class="n">friend2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">user_artists</span><span class="p">[</span><span class="n">user_artists</span><span class="o">.</span><span class="n">userID</span> <span class="o">==</span> <span class="n">row</span><span class="o">.</span><span class="n">friendID</span><span class="p">]</span><span class="o">.</span><span class="n">artistID</span><span class="p">)</span>
    <span class="n">incommon</span> <span class="o">=</span> <span class="n">friend1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">friend2</span><span class="p">)</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">friend1</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">friend2</span><span class="p">)</span>
    <span class="n">pc_incommon</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">incommon</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">total</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">artists_incommon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pc_incommon</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean percentage of artists in common: </span><span class="si">%.2f%%</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">artists_incommon</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean percentage of artists in common: 10.26%
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="create-dataframes-for-recommendation-building">
<h2><span class="section-number">1.5. </span>Create DataFrames for Recommendation Building<a class="headerlink" href="#create-dataframes-for-recommendation-building" title="Permalink to this headline">¶</a></h2>
<div class="section" id="artist-information">
<h3><span class="section-number">1.5.1. </span>Artist Information<a class="headerlink" href="#artist-information" title="Permalink to this headline">¶</a></h3>
<p>Let’s create a datframe that contains information on each artist.
It will contain artist id, name, their 3 most common tags, a list of all their tags, the year they were listened to most and a count of how many times they were listened to.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># function to get the most frequent tags for each artist, if the artist only has 1 tag it will repeat it</span>
<span class="k">def</span> <span class="nf">get_top_n</span><span class="p">(</span><span class="n">tag_list</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">genre_n</span> <span class="o">=</span> <span class="n">tag_list</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">genre_n</span> <span class="o">=</span> <span class="n">tag_list</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">genre_n</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># user_tagged_artists[&#39;tagValue&#39;] = user_tagged_artists.tagID.map(tag_dict)</span>
<span class="n">top_tag</span> <span class="o">=</span> <span class="n">user_tagged_artists_tag</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;artistID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">get_top_n</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">sec_tag</span> <span class="o">=</span> <span class="n">user_tagged_artists_tag</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;artistID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">get_top_n</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">third_tag</span> <span class="o">=</span> <span class="n">user_tagged_artists_tag</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;artistID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">get_top_n</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">all_tags</span> <span class="o">=</span> <span class="n">user_tagged_artists_tag</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;artistID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">peak_year</span> <span class="o">=</span> <span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;artistID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#choses earliest year if there&#39;s a draw</span>
<span class="n">artists_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">top_tag</span><span class="p">,</span><span class="n">sec_tag</span><span class="p">,</span><span class="n">third_tag</span><span class="p">,</span><span class="n">all_tags</span><span class="p">,</span><span class="n">peak_year</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tag_1&#39;</span><span class="p">,</span> <span class="s1">&#39;tag_2&#39;</span><span class="p">,</span><span class="s1">&#39;tag_3&#39;</span><span class="p">,</span><span class="s1">&#39;all_tags&#39;</span><span class="p">,</span><span class="s1">&#39;peak_year&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">artists_df</span><span class="o">.</span><span class="n">artistID</span> <span class="o">=</span> <span class="n">artists_df</span><span class="o">.</span><span class="n">artistID</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>

<span class="n">artists_df</span> <span class="o">=</span> <span class="n">artists</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">artists_df</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;artistID&#39;</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;url&#39;</span><span class="p">,</span><span class="s1">&#39;artistID&#39;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">listens_count</span> <span class="o">=</span> <span class="n">user_artists</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;artistID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="s1">&#39;listen_count&#39;</span><span class="p">)</span>
<span class="n">artists_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">artists_df</span><span class="p">,</span> <span class="n">listens_count</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">artists_df</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">artists_df</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>
<span class="n">artists_df</span><span class="o">.</span><span class="n">peak_year</span> <span class="o">=</span> <span class="n">artists_df</span><span class="o">.</span><span class="n">peak_year</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">2004</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
<span class="n">artists_df</span><span class="o">.</span><span class="n">tag_1</span> <span class="o">=</span> <span class="n">artists_df</span><span class="o">.</span><span class="n">tag_1</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;no_tags&#39;</span><span class="p">)</span>
<span class="n">artists_df</span><span class="o">.</span><span class="n">all_tags</span> <span class="o">=</span> <span class="n">artists_df</span><span class="o">.</span><span class="n">all_tags</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;[]&#39;</span><span class="p">)</span>
<span class="n">artist_features</span><span class="p">[</span><span class="s1">&#39;peak_year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">peak_year</span>
<span class="n">artist_features</span><span class="p">[</span><span class="s1">&#39;all_tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_tags</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">artists_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>tag_1</th>
      <th>tag_2</th>
      <th>tag_3</th>
      <th>all_tags</th>
      <th>peak_year</th>
      <th>listen_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>MALICE MIZER</td>
      <td>jrock</td>
      <td>visualkei</td>
      <td>gothic</td>
      <td>[weeabo, jrock, visualkei, betterthanladygaga,...</td>
      <td>2008</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Diary of Dreams</td>
      <td>darkwave</td>
      <td>german</td>
      <td>gothic</td>
      <td>[german, seenlive, darkwave, industrial, gothi...</td>
      <td>2009</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Carpathian Forest</td>
      <td>blackmetal</td>
      <td>truenorwegianblackmetal</td>
      <td>norwegianblackmetal</td>
      <td>[blackmetal, norwegianblackmetal, truenorwegia...</td>
      <td>2008</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="listens-per-artist">
<h3><span class="section-number">1.5.2. </span>Listens Per Artist<a class="headerlink" href="#listens-per-artist" title="Permalink to this headline">¶</a></h3>
<p>A dataframe contain userID, artistID, and scaled listenCount.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">listens</span> <span class="o">=</span> <span class="n">user_artists</span>
<span class="n">listens</span> <span class="o">=</span> <span class="n">listens</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;listenCount&#39;</span><span class="p">})</span>
<span class="n">listens</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userID</th>
      <th>artistID</th>
      <th>listenCount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>45</td>
      <td>3.047442</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>46</td>
      <td>3.047442</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>47</td>
      <td>3.047442</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="save-files">
<h3><span class="section-number">1.5.3. </span>Save Files<a class="headerlink" href="#save-files" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">artists</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;..</span><span class="se">\\</span><span class="s1">data</span><span class="se">\\</span><span class="s1">processed</span><span class="se">\\</span><span class="s1">artists.csv&#39;</span><span class="p">)</span>
<span class="n">tags</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;..</span><span class="se">\\</span><span class="s1">data</span><span class="se">\\</span><span class="s1">processed</span><span class="se">\\</span><span class="s1">tags.csv&#39;</span><span class="p">)</span>
<span class="n">user_artists</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;..</span><span class="se">\\</span><span class="s1">data</span><span class="se">\\</span><span class="s1">processed</span><span class="se">\\</span><span class="s1">user_artists.csv&#39;</span><span class="p">)</span>
<span class="n">user_friends</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;..</span><span class="se">\\</span><span class="s1">data</span><span class="se">\\</span><span class="s1">processed</span><span class="se">\\</span><span class="s1">user_friends.csv&#39;</span><span class="p">)</span>
<span class="n">user_tagged_artists</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;..</span><span class="se">\\</span><span class="s1">data</span><span class="se">\\</span><span class="s1">processed</span><span class="se">\\</span><span class="s1">user_tagged_artists.csv&#39;</span><span class="p">)</span>
<span class="n">artists_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;..</span><span class="se">\\</span><span class="s1">data</span><span class="se">\\</span><span class="s1">processed</span><span class="se">\\</span><span class="s1">artist_info.csv&#39;</span><span class="p">)</span>
<span class="n">listens</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;..</span><span class="se">\\</span><span class="s1">data</span><span class="se">\\</span><span class="s1">processed</span><span class="se">\\</span><span class="s1">listens.csv&#39;</span><span class="p">)</span>
<span class="n">artist_features</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;..</span><span class="se">\\</span><span class="s1">data</span><span class="se">\\</span><span class="s1">processed</span><span class="se">\\</span><span class="s1">artist_features.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="introd.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Introduction</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="matrix_fact.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Matrix Factorization</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Niamh Murphy<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>